<!DOCTYPE html>
<html lang="en">
{% load staticfiles %}
<head>
    <meta charset="UTF-8">
    <title>Student Page</title>
          <!--Import Google Icon Font-->
    <link href="{% static 'css_file/bootstrap.min.css' %}">
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

      <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <style>
        .register label{
            font-size: 15px;
            margin-left: 10px;
            padding-top: 10px;

        }
            .register{
            margin: 0px;
        }
        body{
            background-color: honeydew;
        }
         .register input,textarea{
            font-size: 20px !important;
             padding-left: 10px;

        }
        span{
            font-size: 20px;
        }
        .custom{
            border: 2px solid;
            background-color: green;
            color: white;
            width: 100%;
            height: 60px;
            margin-top: 0px;
            border-radius: 0px;
        }


    </style>
    <script type="text/javascript">
        $(document).ready(function() {
        Materialize.updateTextFields();
      });
         $('#address').val('New Text');
         $('#address').trigger('autoresize');

     function formValidation(){

         var sid = document.getElementById('sid').value;
         var name = document.getElementById('name').value;
         var email = document.getElementById('email').value;
         var mobile = document.getElementById('mobile').value;
         var password = document.getElementById('password').value;
         var gender1 = document.getElementById('male').checked;
         var gender2 = document.getElementById('female').checked;
         var dob = document.getElementById('dob').value;
         var address = document.getElementById('address').value;
         //Student Id Validation
         if(sid == ""){
              Materialize.toast('**Please Fill Student Roll No....!', 2000,'rounded');
             return false;
         }

         //Student Name Validation
         if(name == ""){
             Materialize.toast('** Please Fill The Student Name...!', 2000,'rounded');
             return false;
         }
         if((name.length < 3) || (name.length >20)){
            Materialize.toast('** Please Fill The Student Name Between 3 and 20', 2000,'rounded');
             return false;
         }
         if(!isNaN(name)){
             Materialize.toast('** Name Only Character..! ', 2000,'rounded');
             return false;
         }
         //Email Validation

         if(email == ""){
             Materialize.toast('** Please Fill the Student Email..! ', 2000,'rounded');
             return false;
         }
         if(email.indexOf('@')<=0){
             Materialize.toast('** Please Fill the Email Id Proper Formate @', 2000,'rounded');
             return false;
         }
         if((email.charAt(email.length-4)!='.') && (email.charAt(email.length-3)!='.')){
             Materialize.toast('** Please Fill the Email Id Proper Formate .', 2000,'rounded');
             return false;
         }




         //Mobile no. validation
         if(mobile == ""){
             Materialize.toast('** Please Fill The Mobile Number', 2000,'rounded');
             return false;
         }
         if(mobile.length !=10){
             Materialize.toast('** Please Enter Only 10 Digits"', 2000,'rounded');
             return false;
         }
         if(isNaN(mobile)){
             Materialize.toast('** Mobile Number Should Contains Only Digit', 2000,'rounded');
             return false;
         }


         //password Validation

         if(password == "") {
             Materialize.toast('** Please Fill the Student Password', 2000,'rounded');
             return false;
         }
         if((password.length < 6) || (password.length >20)){
             Materialize.toast('** Please Fill The Student password Between 6 and 20', 2000,'rounded');
             return false;
         }
         //Gender validation
         if((gender1=="")&&(gender2=="")){
             Materialize.toast('** Please select Either Male or Female', 2000,'rounded');
             return false;
         }
         /*if((genderdata != "male") || (genderdata!="female"))
         {
           document.getElementById('gender1').innerHTML="** Please select Either Male or Female";
             return false;
         }*/
         //DOB Validation
         if(dob==""){
             Materialize.toast('** Please Fill the Student Date Of Birth', 2000,'rounded');
             return false;

         }



         //Address Validation
         if(address==""){
             Materialize.toast('** Please Fill the Student Address', 2000,'rounded');
             return false;
         }


         studentRegistration();




     }
     function  studentRegistration() {
         $.ajax({
             type:'POST',
             url:/student_data_store/,
             data:{
                 sid:$('.sid').val(),
                 name:$('.name').val(),
                 email:$('.email').val(),
                 mobile:$('.mobile').val(),
                 password:$('.password').val(),
                 gender :$('.gender').val(),
                 dob:$('.dob').val(),
                 address:$('.address').val()
             },
             success:function (data) {
                 if(data.success == true){
                     Materialize.toast("Registration Success..!",4000,'rounded');
                     window.location='/dashboard/'
                 }else{
                     Materialize.toast("Registration Failed..!",2000,'rounded');
                 }
                 $('input[type="text"],input[type="number"],input[type="email"],input[type="password"]').val('');
                 $("input:radio").removeAttr("checked");
             }


         });

     }

 </script>
    <!-- current date picker-->
    <script>
        $(document).ready( function() {
            var now = new Date();
            var today = now.getFullYear() + '-' + (now.getMonth() + 1) + '-' + now.getDate();
            $('.dob').val(today);
        });
    </script>
</head>
<body>

 <div class="container-fluid">
   <div class="custom">
         <span style="float:left;padding: 7px;">
           <a href="/dashboard/" class="btn waves-effect" style="border-radius: 10px;"><span>Home</span><i class="material-icons right">home</i> </a>

       </span>
         <span style="float: right;padding: 7px; ">
           <a href="/logout/" class="btn large " style="border-radius: 10px;"><span>Logout</span><i class="material-icons right">lock</i> </a>
         </span>
     </div>
     <div class="row register">

         <div class="col s12 m8 l5 offset-l3  offset-m3 ">
           <div class="card z-depth-3">

               {% if not student %}
             <!--=============================Create Student Record=====================-->
                <div id="formData">
                   <div class="card-content green white-text center-align">
                       <h4>Student Registration Page....!</h4>
                   </div>
                      <div class="row register" style="margin-top: 20px;margin-left: 2%;margin-right: 2%;">
                        <div class="input-field col s12">
                          <input id="sid" type="number" name="sid" class="sid" >
                          <label class="active" for="sid">Student Roll No.</label>

                        </div>

                        <div class="input-field col s12">
                          <input id="name" type="text" name="name" class="name"  autocomplete="off" >
                          <label class="active" for="name">Student Name</label>

                        </div>

                        <div class="input-field col s12">
                          <input id="email" type="email"  name="email" class="validate email" >
                          <label class="active" for="email">Student Email</label>

                        </div>

                        <div class="input-field col s12">
                          <input id="mobile" type="text" name="mobile" class="mobile"  maxlength="10" onkeypress="return numberCheck(event)">
                          <label class="active" for="mobile">Mobile No.</label>

                        </div>

                       <div class="input-field col s12">
                          <input id="password" type="password" class="password" name="password"  >
                          <label class="active" for="password">Enter Password</label>

                        </div>

                        <div style="padding-left: 20px">
                                  <input class="with-gap gender" name="gender" type="radio" id="male"  value="male" />
                                  <label for="male">Male</label>
                                  <input class="with-gap gender" name="gender" type="radio" id="female" value="female"  />
                                  <label for="female">Female</label>

                        </div>


                       <div class="input-field col s12">
                          <input id="dob" type="date" name="dob" value="" class="dob" max="2015-01-01" >
                          <label class="active" for="dob">Date Of Birth</label>

                        </div>

                       <div class="input-field col s12">
                          <input type="text" id="address" name="address" class="address">
                          <label class="active" for="address">Address</label>

                        </div>


                      </div>
                      <div class="btn-group center-align" style="position: relative; bottom: 10px;">
                          <button type="submit" class="btn waves-effect btn-large green submit" id="submit" onclick="return formValidation()" style="padding: 0px;margin: 10px;padding-left: 13px;padding-right: 13px;">
                              <span>Register</span>

                          </button>
                          <a href="/dashboard/" class="btn waves-effect btn-large green" style="padding: 0px;padding-left: 13px;padding-right: 13px;margin: 10px;"><span>Cancel</span>
                           </a>
                      </div>
                      <div class="flow-text red-text">{{ msg }}</div>
                    </div>
                   </div>

                   {% else %}

                   {% for y in student %}


                <!--==============================Update Student Record================-->
                   <div class="updateForm">
                     <div class="card-content green white-text center-align">
                       <h4>Student Updatation Page....!</h4>
                   </div>
                      <div class="row register" style="margin-top: 20px;margin-left: 2%;margin-right: 2%;">
                          <div class="input-field col s12"><span>Roll No. : </span><span style="font-size: 20px;margin-left:10px;font-weight: bold">{{ y.sid }}</span>
                          <input id="sid" type="hidden" value="{{ y.sid }}" name="sid" class="sid">


                        </div>

                        <div class="input-field col s12">
                          <input id="name" type="text" name="name" class="name"  value="{{ y.name }}"  >
                          <label class="active" for="name">Enter Name</label>


                        </div>

                        <div class="input-field col s12">
                          <input id="email" type="email" name="email" value="{{ y.email }}" class="validate email" >
                          <label class="active" for="email">Enter Email</label>


                        </div>

                        <div class="input-field col s12">
                          <input id="mobile" type="text" value="{{ y.mobile }}" class="mobile" name="mobile" maxlength="10" onkeypress="return numberCheck(event)">
                           <label class="active" for="mobile">Enter Mobile</label>


                        </div>

                       <div class="input-field col s12">
                          <input id="password" type="text" value="{{ y.password }}" name="password" class="password">
                          <label class="active" for="password">Enter Password</label>

                        </div>




                       <div class="input-field col s12">
                          <input id="dob1" type="date" name="dob" value="{{y.dob|date:"Y-m-d" }}"  class="dob" max="2015-01-01" >
                          <label class="active" for="dob1">Date Of Birth</label>

                        </div>

                       <div class="input-field col s12">
                          <input type="text" id="address" name="address" class="address"  value="{{ y.address }}">
                          <label class="active" for="address">Address</label>

                        </div>


                      </div>
                      <div class="btn-group center-align" style="position: relative; bottom: 10px;">
                          <button type="submit" class="btn waves-effect btn-large green" onclick="return updateValidation()" style="padding: 0px;padding-left: 13px;padding-right: 13px;margin: 10px;">
                              <span>Update</span>

                          </button>
                          <a href="/dashboard/" class="btn waves-effect btn-large green" style="padding:0px;padding-left: 13px;padding-right: 13px; margin: 10px;"><span>Cancel</span><i class="material-icons right">close</i> </a>
                      </div>


                </div>

                   {% endfor %}

                 {% endif %}



         </div>

     </div>
 </div>
 <!-- form Validation for Updation-->
 <script type="text/javascript">
     function updateValidation() {
         var name = document.getElementById('name').value;
         var email = document.getElementById('email').value;
         var mobile = document.getElementById('mobile').value;
         var password = document.getElementById('password').value;
         var dob = document.getElementById('dob1').value;
         var address = document.getElementById('address').value;

         if(name == ""){
             Materialize.toast('Fill Student Name...!', 2000,'rounded');
             return false;
         }
         else if(!isNaN(name)){
             Materialize.toast('** Please Only Character..! ', 2000,'rounded');
             return false;
         }
         else if(email == ""){
             Materialize.toast('Fill Student Email...!', 2000,'rounded');
             return false;
         }
         else if(email.indexOf('@')<=0)
         {
             Materialize.toast('** Please Fill the Email Id Proper Formate @', 2000,'rounded');
             return false;
         }
         else if((email.charAt(email.length-4) != '.') && (email.charAt(email.length-3)!='.')){
           Materialize.toast('** Please Fill the Email Id Proper Formate .', 2000,'rounded');
             return false;
         }

         else if(mobile == ""){
             Materialize.toast('** Please Fill the Mobile No. .', 2000,'rounded');
             return false;
         }

         else if(password == ""){
             Materialize.toast('** Please Fill the Password. .', 2000,'rounded');
             return false;
         }
         else if(dob == ""){
             Materialize.toast('** Please Fill the Date of Birthday. .', 2000,'rounded');
             return false;
         }
         else if(address == ""){
             Materialize.toast('** Please Fill the Address. .', 2000,'rounded');
             return false;
         }





         updateRecord()

     }
     function updateRecord(){
         $.ajax({
             type: 'POST',
             url:/student_data_update/,
             data:{
                sid:$('.sid').val(),
               name:$('.name').val(),
               email:$('.email').val(),
               mobile:$('.mobile').val(),
               password:$('.password').val(),
               dob:$('.dob').val(),
                 address:$('.address').val(),
             },
             success:function (data) {
                 if(data.success == true){
                     Materialize.toast("Student Recore Update Successfully...!",3000,'rounded');
                     window.location=/dashboard/
                 }else{
                     Materialize.toast("Record Updat Failed...!",3000,'rounded')
                 }
             }
         })
     }
 </script>

  <script type="text/javascript">
        function numberCheck(evt) {
            evt = (evt) ? evt : window.event;
                var charCode = (evt.which) ? evt.which : evt.keyCode;
                if (charCode > 31 && (charCode < 48 || charCode > 57)) {
                    return false;
                }
             return true;

        }
    </script>
</body>
</html>