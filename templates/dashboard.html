<!DOCTYPE html>
<html lang="en">
{% load staticfiles %}
<head>
    <meta charset="UTF-8">
    <title>DashBoard</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

    <style>
        table{
            margin-top: 20px;
            border-collapse: collapse;

        }
        td.updatefont{
            font-size: 20px;
            font-weight: bold;
            color: #9fcdff;
            text-align: center;
            background-color: #1e7e34;


        }
        #formpage{
            display: none;
        }
        tr,th,td{

            border: 1px solid;
            text-align: center;
        }

        .custom_toggle{
            margin-top: 30px;
        }
        td{
            font-size: 20px !important;

        }

        .custom{
            border: 2px solid;
            background-color: green;
            color: white;
            width: 100%;
            height: 60px;
            margin-top: 0px;
            position: relative;
            left: 0px;

        }
        .profile label{
            font-size: 20px;

            margin-left: 5px;
            color: black;
        }
    </style>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#form_button').click(function () {
              $('.form_page').toggle();
            });
            $('.form_page').hide();


        });
        function updateLogedUser() {
            var mobile = document.getElementById('mobile').value;
            var name = document.getElementById('name').value;
            var email = document.getElementById('email').value;
            var password = document.getElementById('password').value;


            if(mobile == ""){
                Materialize.toast("** Fill The Mobile No....",2000,'rounded');
                return false;
            }
            else if(isNaN(mobile)){

                Materialize.toast("Enter Only Character",2000,'rounded');
                return false;
            }
            else if(mobile.length != 10){
                Materialize.toast('Enter 10 Digit Only',2000,'rounded');
                return false;
            }

            if(name == ""){
                Materialize.toast("**Fill The Name...!",2000,'rounded');
                return false;
            }
            else if(email == ""){
             Materialize.toast('Fill Student Email...!', 2000,'rounded');
             return false;
         }
         else if(email.indexOf('@')<=0)
         {
             Materialize.toast('** Please Fill the Email Id Proper Formate @', 2000,'rounded');
             return false;
         }
         else if((email.charAt(email.length-4) != '.') && (email.charAt(email.length-3)!='.')){
           Materialize.toast('** Please Fill the Email Id Proper Formate .', 2000,'rounded');
             return false;
         }
         else if(password == ""){
             Materialize.toast('** Please Fill the Password .', 2000,'rounded');
             return false;
            }
            logedUser()
        }
        function logedUser() {
           $.ajax({
               type:'POST',
               url:'/profile_update/',
               data:{
                   id:$('.id').val(),
                   mobile:$('.mobile').val(),
                   name:$('.name').val(),
                   email:$('.email').val(),
                   password:$('.password').val()
               },
               success:function (data) {
                   if (data.success == true){
                      Materialize.toast("Update Profile.",2000,'rounded') ;
                      window.location=/dashboard/;

                   }else {
                       Materialize.toast('Update Failes.',2000,'rounded');

                   }
               }
           })
        }
        function numberCheck(evt) {
            evt = (evt) ? evt : window.event;
                var charCode = (evt.which) ? evt.which : evt.keyCode;
                if (charCode > 31 && (charCode < 48 || charCode > 57)) {
                    return false;
                }
             return true;

        }

    </script>
</head>

<body>
 <div class="container-fluid">


       <div class="custom">
          <div class="col s12 m12 l12" style="padding: 2px;">
          <img src="{% static 'image/logo.ico' %}" width="50" height="50">
         {% for z in data %}
             <!-- Create Student Record--->
               <span style=" position: absolute;top: 14px; ">
                 <span >{{ z.name }}</span>
               </span>

         {% endfor %}

         <span style="float: right;padding: 7px; ">
           <a href="/logout/" class="btn large " style="border-radius: 10px;"><span>Logout</span><i class="material-icons right">lock</i> </a>
         </span>
          </div>
     </div>


     <div class="row">
       <div class="col s12 l3 m6" style="margin-top: 30px;">
      <!-- Create Toggle-->
       <span class="custom_toggle">
         <button type="button" class="btn waves-effect" style="border-radius: 10px;" name="form_button" id="form_button"> Update Login Profile</button>
        </span>
       <!-- End Toggle-->

           <div id="form_page" class="form_page">

               {% for x in data %}
                <div class="card profile">
                   <div class="card-content green white-text center-align">
                           <h4>Update Login User</h4>
                   </div>


                    <div class='row '>
                              <div class='input-field'>

                                  <input  type='hidden' name='id' id="id" class="id" value="{{ x.id }}" style="width:70%;margin-left: 27%;font-size: 20px; " />
                              </div>
                   </div>
                    <div class='row '>
                              <div class='input-field'>
                                  <label for="mobile" style="position: absolute;top:50%;" >Mobile  </label>
                                  <input  type='text' class="validate mobile" value="{{ x.mobile }}" id="mobile" maxlength="10" autocomplete="off" style="width:70%;margin-left: 27%;font-size: 20px; " onkeypress="return numberCheck(event)"/>
                              </div>
                   </div>
                   <div class='row '>
                              <div class='input-field'>
                                  <label for="name" style="position: absolute;top:50%;" >Name  </label>
                                  <input  type='text' name='name' id="name" class="name" value="{{ x.name }}" style="width:70%;margin-left: 27%;font-size: 20px; " />
                              </div>
                   </div>
                   <div class='row '>
                              <div class='input-field'>
                                  <label for="email" style="position: absolute;top:50%;" >Email  </label>
                                  <input  type='email' name='email' class="validate email" id="email" value="{{ x.email }}" style="width: 70%;margin-left: 27%;font-size: 20px; " />
                              </div>
                   </div>
                   <div class='row '>
                              <div class='input-field'>
                                  <label for="password" style="position: absolute;top:50%;"  >Password </label>
                                  <input  type='password' name='password' id="password" class="password" value="{{ x.password }}" style="width: 70%;margin-left: 27%;font-size: 20px; "/>
                              </div>
                   </div>
                   <div class='row ' align="center" style="position: relative;bottom: 10px;">
                              <button type="submit" class="btn waves-effect waves-light" onclick="return updateLogedUser()"><span>Update</span>
                               </button>
                   </div>

                </div>
               {% endfor %}

           </div>
       </div>

            <div class="col s12 l9 m7">
             <span style="float: right;padding: 7px;">
           <a href="/studentpage/" class="btn waves-effect" style="border-radius: 10px;"><span>Create Student Record</span></a>

       </span>
                <div class="flow-text white green-text center-align"><h3>Student Records</h3></div>
             {% if not student %}
                      <p class="flow-text red-text center-align ">Not Student Record In Database</p>
                 {% else %}
                <table class="bordered highlight" >
                    <thead>
                      <tr align="center">
                        <th>ID</th>
                        <th>Roll No.</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Mobile</th>
                        <th>Gender</th>
                        <th>Date Of Birth</th>
                        <th>Address</th>
                        <th>Update</th>
                          <th>Delete</th></tr>
                    </thead>
                    {% for y in student %}

                     <tbody>
                     <tr align="center">
                     <td>{{ y.id }}</td>
                     <td>{{ y.roll_no }}</td>
                     <td>{{ y.name }}</td>
                     <td>{{ y.email }}</td>
                     <td>{{ y.mobile }}</td>
                     <td>{{ y.gender }}</td>
                     <td>{{y.dob|date:"d-m-Y" }}</td>
                     <td>{{ y.address }}</td>
                     <td>
                       <a href="/studentpage/?id={{y.id }}"  class="green-text"><i class="material-icons" style="font-size: 40px;">edit</i></a>

                     </td>
                     <td>
{#                         <a href="/student_data_delete/?id={{ y.id }}" onclick="return confirm('Are You sure  Delete Record..?')" class="red-text"><i class="material-icons" style="font-size: 40px;">delete_forever</i></a>#}


             <!-- create Model--->

{#                          <a class="waves-effect waves-light modal-trigger red-text" data-id="{{ y.id }}"  data-toggle="modal" data-target="modal1"><i class="material-icons" style="font-size: 40px;">delete_forever</i></a>#}

                  <button type="button" class="btn red-text" data-toggle="modal" data-target="modal1" onclick="return delete_data(this)">Delete</button>

<!--close Model-->


                     </td>
                     </tr>
                     </tbody>
                    {% endfor %}

                        {% endif %}

                </table>
                  <!--Model Content-->
                          <div id="modal1" class="modal white">
                            <div class="modal-content">
                              <h4  class="left-align">Delete Record</h4>
                              <p class="left-align">Are You Sure to delete this Student Record   ?</p>
                            </div>

                            <div class="modal-footer while">
                           <a href="/student_data_delete/?id={{ y.id }}" class="modal-close waves-effect btn waves-light" style="border-radius: 7px;">
                                  <i class="material-icons right">delete</i> Delete</a>
                               <a class="modal-close waves-effect btn waves-light " style="border-radius: 7px;"><i class="material-icons right">cancel</i> Cancel</a>
                            </div>
                      </div>
            <!-- End Model COntent -->
            </div>

        </div>
    </div>



 <script type="text/javascript">

    $(document).ready(function(){
    $('.modal').modal();
  });


 </script>
</body>
</html>